{
  "TestCaseName": "Place An Order and Verify Hierarchy",
  "DataMapFile": "maps/ecommerce.json",
  "Arrange": [
    {
      "Strategy": "JsonFileSeed",
      "Parameters": {
        "table": "Products",
        "dataFile": "data/products.json",
        "allowIdentityInsert": true
      }
    },
    {
      "Strategy": "HierarchicalSeed",
      "Parameters": {
        "dataFile": "data/new_customer_order_map.json",
        "Outputs": [
          {
            "VariableName": "newOrderId",
            "Source": {
              "FromTable": "Orders",
              "SelectColumn": "OrderId",
              "OrderByColumn": "OrderId",
              "OrderDirection": "DESC"
            }
          }
        ]
      }
    }
  ],
  "Act": {
    "Strategy": "ApiCall",
    "Parameters": {
      "Method": "POST",
      "Endpoint": "/api/orders",
      "Payload": {
        "CustomerId": 1,
        "OrderDate": "2025-08-10T15:30:00Z",
        "TotalAmount": 1274.98,
        "OrderStatusId": 2,
        "OrderItems": [
          {
            "ProductId": 101,
            "Quantity": 1,
            "UnitPrice": 1249.99
          },
          {
            "ProductId": 102,
            "Quantity": 2,
            "UnitPrice": 12.49
          }
        ]
      }
    }
  },
  "Assert": [
    {
      "Strategy": "HierarchicalCompare",
      "Parameters": {
        "RootEntity": "Order",
        "FindById": "{newOrderId}",
        "ExpectedDataFile": "expected/full_order_expected.json",
        "IncludePaths": [
          "Customer",
          "OrderStatus",
          "OrderItems.Product"
        ]
      }
    }
  ]
}
